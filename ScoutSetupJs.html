<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
  //initialization
  $(function(){
    //button handlers
    $('#s1-next').click(s1Forward);
    $('#s2-back').click(s2Back);
    $('#s2-next').click(s2Forward);
    $('#s3-back').click(s3Back);
    $('#s3-next').click(s3Next);
  });
    
   
  function changeView(prevStep, nextStep, triggerFunction) {
    var startStepId = '#step' + prevStep,
        newStepId = '#step' + nextStep;
    
    $(startStepId).addClass('hidden');
    if(triggerFunction) {
      $(newStepId).trigger(triggerFunction).removeClass('hidden');
    } else {
      $(newStepId).removeClass('hidden');
    }
  }
  
  
  function s2Load() {
    //do something
  }
  
  //navigation functions
  function s1Forward() {
    //run any functions necessary for data processing
    
    //show next step
    changeView(1,2);
    
  }
  
  function s2Back() {
    changeView(2,1);
  }
  
  function s2Forward() {
    changeView(2,3);
  }
  
  function s3Back() {
    changeView(3,2);
  }
  
  function s3Next() {
    changeView(3,4);
    processData();
  }
  
  function s4Done() {
    $('#s4-next').removeAttr('disabled');
    //google.script.host.close();
  }
  function showStatus(msg, classId) {
    $('#status').removeClass().html(msg);
    if (classId) {
      $('#status').addClass(classId);
    }
  }
  
  function processData() {
    var rows = $('#scout-info').val().split(/\n/g); //create an array for each row of data in the textarea
    console.log(rows);
    var goodScoutData = [];
    for (i = 0; i < rows.length; i++) { //split rows and then add them to goodScoutData
        if(rows[i][2].length > 0) { //if there's a team number in this row's data, prepend it with an apostrophe so that it is stored as a string
          rows[i][2] = "'" + rows[i][2];
        }
        
        goodScoutData.push(rows[i].split(", "));        
    }
    
    var goodTeamData = $('#teams-to-scout').val().toUpperCase().split(/\n/g); //high interest teams
    for (i = 0; i < goodTeamData.length; i++) {
      goodTeamData[i] = goodTeamData[i].toUpperCase(); //make sure all team numbers are uppercase
      
    }
    console.log(goodScoutData);
    console.log(goodTeamData);
    
    google.script.run
          .withSuccessHandler(function() {
            s4Done();
          })
          .saveScoutData(goodScoutData, goodTeamData);
  }
</script>


